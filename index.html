<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ë§áÂà©Ë®àÁÆóÊ©ü - Ë®àÁÆóÊäïË≥áÊî∂ÁõäÔºåË¶èÂäÉË≤°ÂØåËá™Áî±‰πãË∑Ø">
    <meta name="keywords" content="Ë§áÂà©Ë®àÁÆó, ÊäïË≥áË®àÁÆó, Ë≤°ÂØåË¶èÂäÉ, ÁêÜË≤°Â∑•ÂÖ∑">
    <title>ÁôºË≤°Ë®àÁÆóÊ©ü - Ë≤°ÂØåÊàêÈï∑Ê®°Êì¨Âô®</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üí∞</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }
        
        .header h1 {
            font-size: 3em;
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #fff, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            font-size: 1.3em;
            opacity: 0.9;
            font-weight: 500;
        }
        
        .mode-switcher {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 8px;
            border: 1px solid rgba(255,255,255,0.2);
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 30px;
        }
        
        .mode-btn {
            flex: 1;
            background: transparent;
            color: rgba(255,255,255,0.8);
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mode-btn.active {
            background: rgba(255,255,255,0.2);
            color: white;
            box-shadow: 0 4px 15px rgba(255,255,255,0.1);
        }
        
        .mode-btn:hover:not(.active) {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .calculator-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .input-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .input-section h2 {
            font-size: 1.8em;
            margin-bottom: 30px;
            color: #667eea;
            font-weight: 800;
            text-align: center;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group label {
            display: block;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }
        
        .input-wrapper {
            position: relative;
        }
        
        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 15px;
            font-size: 1.1em;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.8);
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }
        
        .unit {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #888;
            font-weight: 600;
        }
        
        .slider-container {
            margin-top: 15px;
        }
        
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }
        
        .calc-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 15px;
            font-size: 1.3em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 20px;
        }
        
        .calc-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
        
        .result-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .result-section h2 {
            font-size: 1.8em;
            margin-bottom: 30px;
            color: #667eea;
            font-weight: 800;
            text-align: center;
            transition: color 0.3s ease;
        }
        
        .result-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .result-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(116, 75, 162, 0.1));
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }
        
        .result-value {
            font-size: 2.2em;
            font-weight: 900;
            color: #667eea;
            margin-bottom: 8px;
        }
        
        .result-label {
            font-size: 1em;
            color: #666;
            font-weight: 600;
        }
        
        .profit-highlight {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin: 20px 0;
        }
        
        .profit-highlight .value {
            font-size: 2.5em;
            font-weight: 900;
            margin-bottom: 10px;
        }
        
        .profit-highlight .label {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 30px;
        }
        
        .chart-container h3 {
            font-size: 1.5em;
            margin-bottom: 25px;
            color: #667eea;
            font-weight: 800;
            text-align: center;
        }
        
        .chart {
            width: 100%;
            height: 300px;
            position: relative;
            background: linear-gradient(to top, rgba(102, 126, 234, 0.1), transparent);
            border-radius: 15px;
            overflow: hidden;
        }
        
        .chart-bars {
            height: 100%;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            padding: 20px;
        }
        
        .chart-bar {
            width: 40px;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.5s ease;
            cursor: pointer;
        }
        
        .chart-bar:hover {
            filter: brightness(1.2);
            transform: scale(1.05);
        }
        
        .chart-bar .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .chart-bar:hover .tooltip {
            opacity: 1;
        }
        
        .year-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8em;
            color: #666;
            font-weight: 600;
        }
        
        .scenarios {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .scenarios h3 {
            font-size: 1.5em;
            margin-bottom: 25px;
            color: #667eea;
            font-weight: 800;
            text-align: center;
        }
        
        .scenario-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .scenario-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(116, 75, 162, 0.1));
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
        }
        
        .scenario-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }
        
        .scenario-title {
            font-size: 1.2em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .scenario-desc {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
        }
        
        .scenario-result {
            font-size: 1.5em;
            font-weight: 900;
            color: #11998e;
        }
        
        .hidden {
            display: none;
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .footer p {
            margin-bottom: 10px;
        }
        
        .footer a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
        }
        
        .share-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            margin: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .share-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .calculator-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .result-cards {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .chart {
                height: 250px;
            }
            
            .chart-bar {
                width: 25px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ ÁôºË≤°Ë®àÁÆóÊ©ü</h1>
            <p>Ë¶ãË≠âË§áÂà©È≠îÊ≥ïÔºåÁÆóÂá∫‰Ω†ÁöÑÊö¥ÂØåËªåË∑° üöÄ Èõ¢Ë≤°ÂØåËá™Áî±ÈÇÑÊúâÂπæÂπ¥Ôºü</p>
        </div>
        
        <!-- Ê®°ÂºèÂàáÊèõ -->
        <div class="mode-switcher">
            <button class="mode-btn active" onclick="switchMode('forward')" id="forwardMode">
                üìà ÊàëËÉΩËÆäÂ§öÊúâÈå¢
            </button>
            <button class="mode-btn" onclick="switchMode('reverse')" id="reverseMode">
                üéØ Â§ö‰πÖËÉΩÊö¥ÂØå
            </button>
        </div>

        <div class="calculator-container">
            <!-- Ê≠£ÂêëË®àÁÆóËº∏ÂÖ•ÂçÄÂüü -->
            <div class="input-section" id="forwardInputs">
                <h2>üéØ Ë®≠ÂÆö‰Ω†ÁöÑÁôºË≤°ÂèÉÊï∏</h2>
                
                <div class="input-group">
                    <label for="principal">ÂïüÂãïË≥áÈáëÔºàÁà∏Â™ΩË¥äÂä©Â§öÂ∞ëÔºâ</label>
                    <div class="input-wrapper">
                        <input type="number" id="principal" value="100000" min="1000" max="10000000">
                        <span class="unit">ÂÖÉ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="principalSlider" min="10000" max="1000000" value="100000" step="10000">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="rate">Âπ¥ÂåñÂ†±ÈÖ¨ÁéáÔºàÂ§öÊúÉË≥∫Èå¢Ôºâ</label>
                    <div class="input-wrapper">
                        <input type="number" id="rate" value="8" min="0.1" max="30" step="0.1">
                        <span class="unit">%</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="rateSlider" min="1" max="25" value="8" step="0.5">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="years">Ë∫∫Âπ≥ÂπæÂπ¥ÂæåÊî∂Èå¢</label>
                    <div class="input-wrapper">
                        <input type="number" id="years" value="10" min="1" max="50">
                        <span class="unit">Âπ¥</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="yearsSlider" min="1" max="40" value="10" step="1">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="monthly">ÊØèÊúàÂÆöÊúü‰∏äË≤¢ÔºàÂ∞ëÂñùÂπæÊùØÈ£≤ÊñôÔºâ</label>
                    <div class="input-wrapper">
                        <input type="number" id="monthly" value="5000" min="0" max="100000">
                        <span class="unit">ÂÖÉ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="monthlySlider" min="0" max="50000" value="5000" step="1000">
                    </div>
                </div>
                
                <button class="calc-btn" onclick="calculateCompound()">
                    üî• ÁÆóÂá∫ÊàëÁöÑÊö¥ÂØåÊåáÊï∏
                </button>
            </div>
            
            <!-- ÂèçÂêëË®àÁÆóËº∏ÂÖ•ÂçÄÂüü -->
            <div class="input-section hidden" id="reverseInputs">
                <h2>üéØ Ë®≠ÂÆö‰Ω†ÁöÑÊö¥ÂØåÁõÆÊ®ô</h2>
                
                <div class="input-group">
                    <label for="targetAmount">ÁõÆÊ®ôÈáëÈ°çÔºàÊÉ≥Ë¶ÅÂ§öÂ∞ëÂ∞èÈå¢Èå¢Ôºâ</label>
                    <div class="input-wrapper">
                        <input type="number" id="targetAmount" value="1000000" min="100000" max="50000000">
                        <span class="unit">ÂÖÉ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="targetSlider" min="100000" max="5000000" value="1000000" step="100000">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="targetRate">È†êÊúüÂπ¥Ë≥∫Èå¢ËÉΩÂäõ</label>
                    <div class="input-wrapper">
                        <input type="number" id="targetRate" value="8" min="1" max="25" step="0.1">
                        <span class="unit">%</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="targetRateSlider" min="1" max="20" value="8" step="0.5">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="initialAmount">ÁèæÊúâÂÆ∂Â∫ïÔºàÂè£Ë¢ãË£°ÊúâÂ§öÂ∞ëÔºâ</label>
                    <div class="input-wrapper">
                        <input type="number" id="initialAmount" value="50000" min="0" max="1000000">
                        <span class="unit">ÂÖÉ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="initialSlider" min="0" max="500000" value="50000" step="10000">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="targetMonthly">ÊØèÊúàËÉΩÁúÅ‰∏ãÂ§öÂ∞ëÔºàÊàíÈ£≤ÊñôÊàíÂÆµÂ§úÔºâ</label>
                    <div class="input-wrapper">
                        <input type="number" id="targetMonthly" value="10000" min="1000" max="100000">
                        <span class="unit">ÂÖÉ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="targetMonthlySlider" min="1000" max="50000" value="10000" step="1000">
                    </div>
                </div>
                
                <button class="calc-btn" onclick="calculateReverse()">
                    üéØ ÁÆóÂá∫ÊàëÂ§ö‰πÖËÉΩÁôºË≤°
                </button>
            </div>
            
            <!-- ÁµêÊûúÂçÄÂüü -->
            <div class="result-section">
                <h2>üìä ‰Ω†ÁöÑÁôºË≤°È†êÊ∏¨</h2>
                
                <div class="result-cards">
                    <div class="result-card">
                        <div class="result-value" id="finalAmount">$0</div>
                        <div class="result-label">ÊúÄÁµÇË∫´ÂÉπ</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="totalInvested">$0</div>
                        <div class="result-label">Á∏ΩÂÖ±Á†∏‰∫ÜÂ§öÂ∞ëÈå¢</div>
                    </div>
                </div>
                
                <div class="profit-highlight">
                    <div class="value" id="totalProfit">$0</div>
                    <div class="label">Ë§áÂà©Âπ´‰Ω†Ë≥∫ÁöÑ (Èå¢ÊªæÈå¢magic) ‚ú®</div>
                </div>
                
                <div class="result-cards">
                    <div class="result-card">
                        <div class="result-value" id="monthlyProfit">$0</div>
                        <div class="result-label">ÊúàÂπ≥ÂùáÁàΩË≥∫</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="roi">0%</div>
                        <div class="result-label">Êï¥È´îÊö¥ÂØåÊåáÊï∏</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ÂúñË°®ÂçÄÂüü -->
        <div class="chart-container hidden" id="chartContainer">
            <h3>üìà Êö¥ÂØåËªåË∑°ÂúñÔºàÁúãÈå¢Èå¢ÊÄéÈ∫ºÈï∑Â§ßÔºâ</h3>
            <div class="chart">
                <div class="chart-bars" id="chartBars">
                    <!-- ÂúñË°®Êü±ÁãÄÂúñÊúÉÂú®ÈÄôË£°ÁîüÊàê -->
                </div>
            </div>
        </div>
        
        <!-- ÊäïË≥áÊÉÖÂ¢ÉÊØîËºÉ -->
        <div class="scenarios hidden" id="scenarios">
            <h3>üé≠ ‰∏çÂêåË∫∫Ë≥∫Á≠ñÁï•ÊØîËºÉÔºàÈÅ∏‰Ω†ÁöÑÁôºË≤°Ë∑ØÁ∑öÔºâ</h3>
            <div class="scenario-grid" id="scenarioGrid">
                <!-- ÊÉÖÂ¢ÉÂç°ÁâáÊúÉÂú®ÈÄôË£°ÁîüÊàê -->
            </div>
        </div>
        
        <!-- È†ÅÂ∞æ -->
        <div class="footer">
            <p>üìö ÊäïË≥áÊúâÈ¢®Èö™ÔºåÁêÜË≤°ÈúÄË¨πÊÖé„ÄÇÊú¨Â∑•ÂÖ∑ÂÉÖ‰æõÂèÉËÄÉÔºå‰∏çÊßãÊàêÊäïË≥áÂª∫Ë≠∞„ÄÇ</p>
            <p>üí° Ë®ò‰ΩèÔºöÊúÄÂ•ΩÁöÑÊäïË≥áÊòØÊäïË≥áËá™Â∑±ÁöÑÁü•Ë≠òÂíåËÉΩÂäõÔºÅ</p>
            <div style="margin-top: 20px;">
                <button class="share-btn" onclick="shareResult()">üì± ÂàÜ‰∫´ÁµêÊûú</button>
                <button class="share-btn" onclick="resetCalculator()">üîÑ ÈáçÊñ∞Ë®àÁÆó</button>
            </div>
        </div>
    </div>
    
    <script>
        // Ê†ºÂºèÂåñÈáëÈ°çÈ°ØÁ§∫
        function formatMoney(amount) {
            if (amount >= 1000000000) {
                return (amount / 1000000000).toFixed(1) + 'ÂÑÑ';
            } else if (amount >= 10000) {
                return (amount / 10000).toFixed(1) + 'Ëê¨';
            } else {
                return Math.round(amount).toLocaleString();
            }
        }
        
        // Ê®°ÂºèÂàáÊèõÂäüËÉΩ
        function switchMode(mode) {
            const forwardBtn = document.getElementById('forwardMode');
            const reverseBtn = document.getElementById('reverseMode');
            const forwardInputs = document.getElementById('forwardInputs');
            const reverseInputs = document.getElementById('reverseInputs');
            
            if (mode === 'forward') {
                forwardBtn.classList.add('active');
                reverseBtn.classList.remove('active');
                forwardInputs.classList.remove('hidden');
                reverseInputs.classList.add('hidden');
                calculateCompound();
            } else {
                reverseBtn.classList.add('active');
                forwardBtn.classList.remove('active');
                reverseInputs.classList.remove('hidden');
                forwardInputs.classList.add('hidden');
                calculateReverse();
            }
        }
        
        // Ë§áÂà©Ë®àÁÆó‰∏ªÂáΩÊï∏
        function calculateCompound() {
            const principal = parseFloat(document.getElementById('principal').value) || 0;
            const rate = parseFloat(document.getElementById('rate').value) / 100 || 0;
            const years = parseInt(document.getElementById('years').value) || 0;
            const monthly = parseFloat(document.getElementById('monthly').value) || 0;
            
            if (principal <= 0 || rate <= 0 || years <= 0) {
                return;
            }
            
            let yearlyData = [];
            let currentAmount = principal;
            let totalInvested = principal;
            
            for (let year = 1; year <= years; year++) {
                const yearStartAmount = currentAmount;
                const yearlyContribution = monthly * 12;
                const interestEarned = (currentAmount + yearlyContribution / 2) * rate;
                
                currentAmount = currentAmount * (1 + rate) + yearlyContribution * (1 + rate / 2);
                totalInvested += yearlyContribution;
                
                yearlyData.push({
                    year: year,
                    startAmount: yearStartAmount,
                    contribution: yearlyContribution,
                    interest: interestEarned,
                    endAmount: currentAmount
                });
            }
            
            const finalAmount = currentAmount;
            const totalProfit = finalAmount - totalInvested;
            const monthlyProfit = totalProfit / (years * 12);
            const roi = ((finalAmount - totalInvested) / totalInvested) * 100;
            
            // Êõ¥Êñ∞ÁµêÊûúÈ°ØÁ§∫
            document.getElementById('finalAmount').textContent = '$' + formatMoney(finalAmount);
            document.getElementById('totalInvested').textContent = '$' + formatMoney(totalInvested);
            document.getElementById('totalProfit').textContent = '$' + formatMoney(totalProfit);
            document.getElementById('monthlyProfit').textContent = '$' + formatMoney(monthlyProfit);
            document.getElementById('roi').textContent = roi.toFixed(1) + '%';
            
            // ÈáçÁΩÆÁµêÊûúÊ®ôÈ°å
            const resultSection = document.querySelector('.result-section h2');
            resultSection.innerHTML = 'üìä ‰Ω†ÁöÑÁôºË≤°È†êÊ∏¨';
            resultSection.style.color = '#667eea';
            
            // È°ØÁ§∫ÂúñË°®ÂíåË°®Ê†º
            showChart(yearlyData);
            showScenarios(principal, rate, years, monthly);
            
            // È°ØÁ§∫Èö±ËóèÁöÑÂçÄÂüü
            ['chartContainer', 'scenarios'].forEach(function(id) {
                const element = document.getElementById(id);
                element.classList.remove('hidden');
                element.classList.add('fade-in');
            });
            
            // Â≠òÂÑ≤ÁµêÊûúÁî®ÊñºÂàÜ‰∫´
            window.currentResult = {
                finalAmount: finalAmount,
                totalInvested: totalInvested,
                totalProfit: totalProfit,
                years: years,
                roi: roi
            };
        }
        
        // ÂèçÂêëË®àÁÆóÔºöÈÅîÊàêÁõÆÊ®ôÈúÄË¶ÅÂ§ö‰πÖ
        function calculateReverse() {
            const targetAmount = parseFloat(document.getElementById('targetAmount').value) || 0;
            const rate = parseFloat(document.getElementById('targetRate').value) / 100 || 0;
            const initialAmount = parseFloat(document.getElementById('initialAmount').value) || 0;
            const monthlyAmount = parseFloat(document.getElementById('targetMonthly').value) || 0;
            
            if (targetAmount <= 0 || rate <= 0) {
                return;
            }
            
            // Ë®àÁÆóÈúÄË¶ÅÁöÑÂπ¥Êï∏
            let years = 0;
            let currentAmount = initialAmount;
            let yearlyData = [];
            let totalInvested = initialAmount;
            
            while (currentAmount < targetAmount && years < 50) {
                years++;
                const yearStartAmount = currentAmount;
                const yearlyContribution = monthlyAmount * 12;
                const interestEarned = (currentAmount + yearlyContribution / 2) * rate;
                
                currentAmount = currentAmount * (1 + rate) + yearlyContribution * (1 + rate / 2);
                totalInvested += yearlyContribution;
                
                yearlyData.push({
                    year: years,
                    startAmount: yearStartAmount,
                    contribution: yearlyContribution,
                    interest: interestEarned,
                    endAmount: currentAmount
                });
            }
            
            const finalAmount = currentAmount;
            const totalProfit = finalAmount - totalInvested;
            const monthlyProfit = totalProfit / (years * 12);
            const roi = ((finalAmount - totalInvested) / totalInvested) * 100;
            
            // Êõ¥Êñ∞ÁµêÊûúÈ°ØÁ§∫
            document.getElementById('finalAmount').textContent = '$' + formatMoney(finalAmount);
            document.getElementById('totalInvested').textContent = '$' + formatMoney(totalInvested);
            document.getElementById('totalProfit').textContent = '$' + formatMoney(totalProfit);
            document.getElementById('monthlyProfit').textContent = '$' + formatMoney(monthlyProfit);
            document.getElementById('roi').textContent = roi.toFixed(1) + '%';
            
            // È°ØÁ§∫ÁõÆÊ®ôÈÅîÊàê‰ø°ÊÅØ
            updateResultTitle(years, targetAmount, currentAmount >= targetAmount);
            
            // È°ØÁ§∫ÂúñË°®ÂíåË°®Ê†º
            showChart(yearlyData);
            showReverseScenarios(targetAmount, initialAmount, monthlyAmount);
            
            // È°ØÁ§∫Èö±ËóèÁöÑÂçÄÂüü
            ['chartContainer', 'scenarios'].forEach(function(id) {
                const element = document.getElementById(id);
                element.classList.remove('hidden');
                element.classList.add('fade-in');
            });
            
            // Â≠òÂÑ≤ÁµêÊûúÁî®ÊñºÂàÜ‰∫´
            window.currentResult = {
                finalAmount: finalAmount,
                totalInvested: totalInvested,
                totalProfit: totalProfit,
                years: years,
                roi: roi,
                targetAmount: targetAmount,
                achieved: currentAmount >= targetAmount
            };
        }
        
        // Êõ¥Êñ∞ÁµêÊûúÊ®ôÈ°å
        function updateResultTitle(years, targetAmount, achieved) {
            const resultSection = document.querySelector('.result-section h2');
            if (achieved) {
                resultSection.innerHTML = 'üéâ ÁàΩÔºÅ' + years + 'Âπ¥ÂæåÂ∞±ËÉΩÈÅîÊ®ô';
                resultSection.style.color = '#11998e';
            } else {
                resultSection.innerHTML = 'üòÖ ÈúÄË¶ÅË∂ÖÈÅé50Âπ¥ÊâçËÉΩÈÅîÊàêÔºàÂ§™Èõ£‰∫ÜÂêßÔºâ';
                resultSection.style.color = '#e74c3c';
            }
        }
        
        // È°ØÁ§∫ÂúñË°®
        function showChart(data) {
            const chartBars = document.getElementById('chartBars');
            chartBars.innerHTML = '';
            
            const maxAmount = Math.max.apply(Math, data.map(function(d) { return d.endAmount; }));
            
            data.forEach(function(yearData, index) {
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                
                const height = (yearData.endAmount / maxAmount) * 250;
                bar.style.height = height + 'px';
                
                bar.innerHTML = '<div class="tooltip">Á¨¨' + yearData.year + 'Âπ¥<br>Ë∫´ÂÉπ$' + formatMoney(yearData.endAmount) + '</div><div class="year-label">' + yearData.year + '</div>';
                
                chartBars.appendChild(bar);
            });
        }
        
        // È°ØÁ§∫‰∏çÂêåÊÉÖÂ¢ÉÊØîËºÉ
        function showScenarios(principal, baseRate, years, monthly) {
            const scenarios = [
                { name: '‰ΩõÁ≥ªË∫∫Ë≥∫', desc: 'ÂÆöÂ≠ò„ÄÅÂÇµÂà∏', rate: 0.02, emoji: 'üßò‚Äç‚ôÇÔ∏è' },
                { name: 'Á©©ÂÅ•Ëá¥ÂØå', desc: 'ETF„ÄÅÂü∫Èáë', rate: 0.06, emoji: 'üìä' },
                { name: 'Á©çÊ•µÊö¥ÂØå', desc: 'ÂÄãËÇ°„ÄÅÊàêÈï∑ËÇ°', rate: 0.10, emoji: 'üìà' },
                { name: 'YOLOÊ¢≠Âìà', desc: 'Âä†ÂØÜË≤®Âπ£„ÄÅÊúüÊ¨ä', rate: 0.15, emoji: 'üöÄ' }
            ];
            
            const scenarioGrid = document.getElementById('scenarioGrid');
            scenarioGrid.innerHTML = '';
            
            scenarios.forEach(function(scenario) {
                const finalAmount = calculateScenario(principal, scenario.rate, years, monthly);
                const card = document.createElement('div');
                card.className = 'scenario-card';
                card.innerHTML = '<div class="scenario-title">' + scenario.emoji + ' ' + scenario.name + '</div><div class="scenario-desc">' + scenario.desc + '<br>Âπ¥Ë≥∫ ' + (scenario.rate * 100).toFixed(1) + '%</div><div class="scenario-result">$' + formatMoney(finalAmount) + '</div>';
                scenarioGrid.appendChild(card);
            });
        }
        
        // ÂèçÂêëË®àÁÆóÁöÑÊÉÖÂ¢ÉÊØîËºÉ
        function showReverseScenarios(targetAmount, initialAmount, monthlyAmount) {
            const scenarios = [
                { name: 'Â§öÊäïÈªûÈå¢', desc: 'ÊØèÊúàÂ§öÁ†∏3000ÂÖÉ', monthly: monthlyAmount + 3000, emoji: 'üí™' },
                { name: 'ÈÅ∏Êõ¥ÁåõÁöÑ', desc: 'Ë≤∑ÊàêÈï∑ËÇ°Ë°ù‰∏ÄÊ≥¢', rate: 0.12, monthly: monthlyAmount, emoji: 'üöÄ' },
                { name: 'Âä†Á¢ºÊú¨Èáë', desc: 'Â§öÊäïÂÖ•10Ëê¨ÂïüÂãïÈáë', initial: initialAmount + 100000, monthly: monthlyAmount, emoji: 'üí∞' },
                { name: 'ÂÖ®Èù¢ÈñãÁÅ´', desc: 'Â§öÊäïË≥á+È´òÂ†±ÈÖ¨', monthly: monthlyAmount + 2000, rate: 0.10, emoji: '‚ö°' }
            ];
            
            const scenarioGrid = document.getElementById('scenarioGrid');
            scenarioGrid.innerHTML = '';
            
            const baseRate = parseFloat(document.getElementById('targetRate').value) / 100;
            
            scenarios.forEach(function(scenario) {
                const rate = scenario.rate || baseRate;
                const monthly = scenario.monthly || monthlyAmount;
                const initial = scenario.initial || initialAmount;
                
                const years = calculateYearsNeeded(targetAmount, rate, initial, monthly);
                const card = document.createElement('div');
                card.className = 'scenario-card';
                card.innerHTML = '<div class="scenario-title">' + scenario.emoji + ' ' + scenario.name + '</div><div class="scenario-desc">' + scenario.desc + '</div><div class="scenario-result">' + (years < 50 ? years + 'Âπ¥Â∞±ÁôºË≤°' : 'Â§™Èõ£‰∫ÜË∂ÖÈÅé50Âπ¥') + '</div>';
                scenarioGrid.appendChild(card);
            });
        }
        
        // Ë®àÁÆóÈÅîÊàêÁõÆÊ®ôÈúÄË¶ÅÁöÑÂπ¥Êï∏
        function calculateYearsNeeded(targetAmount, rate, initialAmount, monthlyAmount) {
            let years = 0;
            let currentAmount = initialAmount;
            
            while (currentAmount < targetAmount && years < 50) {
                years++;
                currentAmount = currentAmount * (1 + rate) + monthlyAmount * 12 * (1 + rate / 2);
            }
            
            return years;
        }
        
        // Ë®àÁÆóÁâπÂÆöÊÉÖÂ¢ÉÁöÑÁµêÊûú
        function calculateScenario(principal, rate, years, monthly) {
            let amount = principal;
            for (let year = 1; year <= years; year++) {
                amount = amount * (1 + rate) + monthly * 12 * (1 + rate / 2);
            }
            return amount;
        }
        
        // ÂàÜ‰∫´ÁµêÊûú
        function shareResult() {
            if (!window.currentResult) {
                alert('Ë´ãÂÖàË®àÁÆóÁµêÊûúÔºÅ');
                return;
            }
            
            const result = window.currentResult;
            let shareText = `üí∞ ÊàëÁöÑÁôºË≤°Ë®àÁÆóÁµêÊûúÔºö\n`;
            shareText += `üéØ ÊúÄÁµÇË∫´ÂÉπÔºö$${formatMoney(result.finalAmount)}\n`;
            shareText += `üíµ Á∏ΩÊäïÂÖ•Ôºö$${formatMoney(result.totalInvested)}\n`;
            shareText += `‚ú® Ë§áÂà©Ë≥∫‰∫ÜÔºö$${formatMoney(result.totalProfit)}\n`;
            shareText += `üìà Êö¥ÂØåÊåáÊï∏Ôºö${result.roi.toFixed(1)}%\n`;
            shareText += `‚è∞ ÊäïË≥áÂπ¥ÈôêÔºö${result.years}Âπ¥\n\n`;
            shareText += `Âø´‰æÜË©¶Ë©¶‰Ω†ÁöÑÁôºË≤°ËªåË∑°ÔºÅ`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'ÁôºË≤°Ë®àÁÆóÊ©ü - ÊàëÁöÑÊäïË≥áÁµêÊûú',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                // Ë§áË£ΩÂà∞Ââ™Ë≤ºÊùø
                navigator.clipboard.writeText(shareText).then(function() {
                    alert('ÁµêÊûúÂ∑≤Ë§áË£ΩÂà∞Ââ™Ë≤ºÊùøÔºÅ');
                });
            }
        }
        
        // ÈáçÁΩÆË®àÁÆóÂô®
        function resetCalculator() {
            // ÈáçÁΩÆÊâÄÊúâËº∏ÂÖ•ÂÄºÁÇ∫È†êË®≠ÂÄº
            document.getElementById('principal').value = 100000;
            document.getElementById('rate').value = 8;
            document.getElementById('years').value = 10;
            document.getElementById('monthly').value = 5000;
            
            document.getElementById('targetAmount').value = 1000000;
            document.getElementById('targetRate').value = 8;
            document.getElementById('initialAmount').value = 50000;
            document.getElementById('targetMonthly').value = 10000;
            
            // ÂêåÊ≠•ÊªëÊ°ø
            syncAllSliders();
            
            // ÈáçÊñ∞Ë®àÁÆó
            if (document.getElementById('forwardMode').classList.contains('active')) {
                calculateCompound();
            } else {
                calculateReverse();
            }
        }
        
        // ÂêåÊ≠•ÊâÄÊúâÊªëÊ°ø
        function syncAllSliders() {
            const inputs = [
                { input: 'principal', slider: 'principalSlider' },
                { input: 'rate', slider: 'rateSlider' },
                { input: 'years', slider: 'yearsSlider' },
                { input: 'monthly', slider: 'monthlySlider' },
                { input: 'targetAmount', slider: 'targetSlider' },
                { input: 'targetRate', slider: 'targetRateSlider' },
                { input: 'initialAmount', slider: 'initialSlider' },
                { input: 'targetMonthly', slider: 'targetMonthlySlider' }
            ];
            
            inputs.forEach(function(item) {
                const input = document.getElementById(item.input);
                const slider = document.getElementById(item.slider);
                if (input && slider) {
                    slider.value = input.value;
                }
            });
        }
        
        // ÂêåÊ≠•ÊªëÊ°øÂíåËº∏ÂÖ•Ê°Ü
        function syncInputs() {
            const inputs = [
                { input: 'principal', slider: 'principalSlider' },
                { input: 'rate', slider: 'rateSlider' },
                { input: 'years', slider: 'yearsSlider' },
                { input: 'monthly', slider: 'monthlySlider' },
                { input: 'targetAmount', slider: 'targetSlider' },
                { input: 'targetRate', slider: 'targetRateSlider' },
                { input: 'initialAmount', slider: 'initialSlider' },
                { input: 'targetMonthly', slider: 'targetMonthlySlider' }
            ];
            
            inputs.forEach(function(item) {
                const input = document.getElementById(item.input);
                const slider = document.getElementById(item.slider);
                
                if (input && slider) {
                    input.addEventListener('input', function() {
                        slider.value = input.value;
                        if (document.getElementById('forwardMode').classList.contains('active')) {
                            calculateCompound();
                        } else {
                            calculateReverse();
                        }
                    });
                    
                    slider.addEventListener('input', function() {
                        input.value = slider.value;
                        if (document.getElementById('forwardMode').classList.contains('active')) {
                            calculateCompound();
                        } else {
                            calculateReverse();
                        }
                    });
                }
            });
        }
        
        // ÂÑ≤Â≠òÂíåÂä†ËºâË®≠ÂÆö
        function saveSettings() {
            const settings = {
                principal: document.getElementById('principal').value,
                rate: document.getElementById('rate').value,
                years: document.getElementById('years').value,
                monthly: document.getElementById('monthly').value,
                targetAmount: document.getElementById('targetAmount').value,
                targetRate: document.getElementById('targetRate').value,
                initialAmount: document.getElementById('initialAmount').value,
                targetMonthly: document.getElementById('targetMonthly').value,
                mode: document.getElementById('forwardMode').classList.contains('active') ? 'forward' : 'reverse'
            };
            localStorage.setItem('wealth-calculator-settings', JSON.stringify(settings));
        }
        
        function loadSettings() {
            const saved = localStorage.getItem('wealth-calculator-settings');
            if (saved) {
                const settings = JSON.parse(saved);
                
                document.getElementById('principal').value = settings.principal || 100000;
                document.getElementById('rate').value = settings.rate || 8;
                document.getElementById('years').value = settings.years || 10;
                document.getElementById('monthly').value = settings.monthly || 5000;
                document.getElementById('targetAmount').value = settings.targetAmount || 1000000;
                document.getElementById('targetRate').value = settings.targetRate || 8;
                document.getElementById('initialAmount').value = settings.initialAmount || 50000;
                document.getElementById('targetMonthly').value = settings.targetMonthly || 10000;
                
                syncAllSliders();
                
                if (settings.mode) {
                    switchMode(settings.mode);
                }
            }
        }
        
        // Ëá™Âãï‰øùÂ≠òË®≠ÂÆö
        function autoSave() {
            const inputs = document.querySelectorAll('input');
            inputs.forEach(function(input) {
                input.addEventListener('change', saveSettings);
            });
        }
        
        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            syncInputs();
            autoSave();
            loadSettings();
            if (!localStorage.getItem('wealth-calculator-settings')) {
                switchMode('forward');
            }
        });
    </script>
</body>
</html>
