<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="è¤‡åˆ©è¨ˆç®—æ©Ÿ - è¨ˆç®—æŠ•è³‡æ”¶ç›Šï¼Œè¦åŠƒè²¡å¯Œè‡ªç”±ä¹‹è·¯">
    <meta name="keywords" content="è¤‡åˆ©è¨ˆç®—, æŠ•è³‡è¨ˆç®—, è²¡å¯Œè¦åŠƒ, ç†è²¡å·¥å…·">
    <title>ç™¼è²¡è¨ˆç®—æ©Ÿ - è²¡å¯Œæˆé•·æ¨¡æ“¬å™¨</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’°</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }
        
        .header h1 {
            font-size: 3em;
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #fff, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            font-size: 1.3em;
            opacity: 0.9;
            font-weight: 500;
        }
        
        .mode-switcher {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 8px;
            border: 1px solid rgba(255,255,255,0.2);
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 30px;
        }
        
        .mode-btn {
            flex: 1;
            background: transparent;
            color: rgba(255,255,255,0.8);
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mode-btn.active {
            background: rgba(255,255,255,0.2);
            color: white;
            box-shadow: 0 4px 15px rgba(255,255,255,0.1);
        }
        
        .mode-btn:hover:not(.active) {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .calculator-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .input-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .input-section h2 {
            font-size: 1.8em;
            margin-bottom: 30px;
            color: #667eea;
            font-weight: 800;
            text-align: center;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group label {
            display: block;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }
        
        .input-wrapper {
            position: relative;
        }
        
        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 15px;
            font-size: 1.1em;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.8);
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }
        
        .unit {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #888;
            font-weight: 600;
        }
        
        .slider-container {
            margin-top: 15px;
        }
        
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }
        
        .calc-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 15px;
            font-size: 1.3em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 20px;
        }
        
        .calc-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
        
        .result-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .result-section h2 {
            font-size: 1.8em;
            margin-bottom: 30px;
            color: #667eea;
            font-weight: 800;
            text-align: center;
            transition: color 0.3s ease;
        }
        
        .result-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .result-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(116, 75, 162, 0.1));
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }
        
        .result-value {
            font-size: 2.2em;
            font-weight: 900;
            color: #667eea;
            margin-bottom: 8px;
        }
        
        .result-label {
            font-size: 1em;
            color: #666;
            font-weight: 600;
        }
        
        .profit-highlight {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin: 20px 0;
        }
        
        .profit-highlight .value {
            font-size: 2.5em;
            font-weight: 900;
            margin-bottom: 10px;
        }
        
        .profit-highlight .label {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 30px;
        }
        
        .chart-container h3 {
            font-size: 1.5em;
            margin-bottom: 25px;
            color: #667eea;
            font-weight: 800;
            text-align: center;
        }
        
        .chart {
            width: 100%;
            height: 300px;
            position: relative;
            background: linear-gradient(to top, rgba(102, 126, 234, 0.1), transparent);
            border-radius: 15px;
            overflow: hidden;
        }
        
        .chart-bars {
            height: 100%;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            padding: 20px;
        }
        
        .chart-bar {
            width: 40px;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.5s ease;
            cursor: pointer;
        }
        
        .chart-bar:hover {
            filter: brightness(1.2);
            transform: scale(1.05);
        }
        
        .chart-bar .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .chart-bar:hover .tooltip {
            opacity: 1;
        }
        
        .year-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8em;
            color: #666;
            font-weight: 600;
        }
        
        .scenarios {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .scenarios h3 {
            font-size: 1.5em;
            margin-bottom: 25px;
            color: #667eea;
            font-weight: 800;
            text-align: center;
        }
        
        .scenario-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .scenario-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(116, 75, 162, 0.1));
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
        }
        
        .scenario-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }
        
        .scenario-title {
            font-size: 1.2em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .scenario-desc {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
        }
        
        .scenario-result {
            font-size: 1.5em;
            font-weight: 900;
            color: #11998e;
        }
        
        .hidden {
            display: none;
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .footer p {
            margin-bottom: 10px;
        }
        
        .footer a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
        }
        
        .share-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            margin: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .share-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .calculator-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .result-cards {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .chart {
                height: 250px;
            }
            
            .chart-bar {
                width: 25px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ’° ç™¼è²¡è¨ˆç®—æ©Ÿ</h1>
            <p>è¦‹è­‰è¤‡åˆ©é­”æ³•ï¼Œç®—å‡ºä½ çš„æš´å¯Œè»Œè·¡ ğŸš€ é›¢è²¡å¯Œè‡ªç”±é‚„æœ‰å¹¾å¹´ï¼Ÿ</p>
        </div>
        
        <!-- æ¨¡å¼åˆ‡æ› -->
        <div class="mode-switcher">
            <button class="mode-btn active" onclick="switchMode('forward')" id="forwardMode">
                ğŸ“ˆ æˆ‘èƒ½è®Šå¤šæœ‰éŒ¢
            </button>
            <button class="mode-btn" onclick="switchMode('reverse')" id="reverseMode">
                ğŸ¯ å¤šä¹…èƒ½æš´å¯Œ
            </button>
        </div>

        <div class="calculator-container">
            <!-- æ­£å‘è¨ˆç®—è¼¸å…¥å€åŸŸ -->
            <div class="input-section" id="forwardInputs">
                <h2>ğŸ¯ è¨­å®šä½ çš„ç™¼è²¡åƒæ•¸</h2>
                
                <div class="input-group">
                    <label for="principal">å•Ÿå‹•è³‡é‡‘ï¼ˆçˆ¸åª½è´ŠåŠ©å¤šå°‘ï¼‰</label>
                    <div class="input-wrapper">
                        <input type="number" id="principal" value="100000" min="1000" max="10000000">
                        <span class="unit">å…ƒ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="principalSlider" min="10000" max="1000000" value="100000" step="10000">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="rate">å¹´åŒ–å ±é…¬ç‡ï¼ˆå¤šæœƒè³ºéŒ¢ï¼‰</label>
                    <div class="input-wrapper">
                        <input type="number" id="rate" value="8" min="0.1" max="30" step="0.1">
                        <span class="unit">%</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="rateSlider" min="1" max="25" value="8" step="0.5">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="years">èººå¹³å¹¾å¹´å¾Œæ”¶éŒ¢</label>
                    <div class="input-wrapper">
                        <input type="number" id="years" value="10" min="1" max="50">
                        <span class="unit">å¹´</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="yearsSlider" min="1" max="40" value="10" step="1">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="monthly">æ¯æœˆå®šæœŸä¸Šè²¢ï¼ˆå°‘å–å¹¾æ¯é£²æ–™ï¼‰</label>
                    <div class="input-wrapper">
                        <input type="number" id="monthly" value="5000" min="0" max="100000">
                        <span class="unit">å…ƒ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="monthlySlider" min="0" max="50000" value="5000" step="1000">
                    </div>
                </div>
                
                <button class="calc-btn" onclick="calculateCompound()">
                    ğŸ”¥ ç®—å‡ºæˆ‘çš„æš´å¯ŒæŒ‡æ•¸
                </button>
            </div>
            
            <!-- åå‘è¨ˆç®—è¼¸å…¥å€åŸŸ -->
            <div class="input-section hidden" id="reverseInputs">
                <h2>ğŸ¯ è¨­å®šä½ çš„æš´å¯Œç›®æ¨™</h2>
                
                <div class="input-group">
                    <label for="targetAmount">ç›®æ¨™é‡‘é¡ï¼ˆæƒ³è¦å¤šå°‘å°éŒ¢éŒ¢ï¼‰</label>
                    <div class="input-wrapper">
                        <input type="number" id="targetAmount" value="1000000" min="100000" max="50000000">
                        <span class="unit">å…ƒ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="targetSlider" min="100000" max="5000000" value="1000000" step="100000">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="targetRate">é æœŸå¹´è³ºéŒ¢èƒ½åŠ›</label>
                    <div class="input-wrapper">
                        <input type="number" id="targetRate" value="8" min="1" max="25" step="0.1">
                        <span class="unit">%</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="targetRateSlider" min="1" max="20" value="8" step="0.5">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="initialAmount">ç¾æœ‰å®¶åº•ï¼ˆå£è¢‹è£¡æœ‰å¤šå°‘ï¼‰</label>
                    <div class="input-wrapper">
                        <input type="number" id="initialAmount" value="50000" min="0" max="1000000">
                        <span class="unit">å…ƒ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="initialSlider" min="0" max="500000" value="50000" step="10000">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="targetMonthly">æ¯æœˆèƒ½çœä¸‹å¤šå°‘ï¼ˆæˆ’é£²æ–™æˆ’å®µå¤œï¼‰</label>
                    <div class="input-wrapper">
                        <input type="number" id="targetMonthly" value="10000" min="1000" max="100000">
                        <span class="unit">å…ƒ</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="targetMonthlySlider" min="1000" max="50000" value="10000" step="1000">
                    </div>
                </div>
                
                <button class="calc-btn" onclick="calculateReverse()">
                    ğŸ¯ ç®—å‡ºæˆ‘å¤šä¹…èƒ½ç™¼è²¡
                </button>
            </div>
            
            <!-- çµæœå€åŸŸ -->
            <div class="result-section">
                <h2>ğŸ“Š ä½ çš„ç™¼è²¡é æ¸¬</h2>
                
                <div class="result-cards">
                    <div class="result-card">
                        <div class="result-value" id="finalAmount">$0</div>
                        <div class="result-label">æœ€çµ‚èº«åƒ¹</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="totalInvested">$0</div>
                        <div class="result-label">ç¸½å…±ç ¸äº†å¤šå°‘éŒ¢</div>
                    </div>
                </div>
                
                <div class="profit-highlight">
                    <div class="value" id="totalProfit">$0</div>
                    <div class="label">è¤‡åˆ©å¹«ä½ è³ºçš„ (éŒ¢æ»¾éŒ¢magic) âœ¨</div>
                </div>
                
                <div class="result-cards">
                    <div class="result-card">
                        <div class="result-value" id="monthlyProfit">$0</div>
                        <div class="result-label">æœˆå¹³å‡çˆ½è³º</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="roi">0%</div>
                        <div class="result-label">æ•´é«”æš´å¯ŒæŒ‡æ•¸</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åœ–è¡¨å€åŸŸ -->
        <div class="chart-container hidden" id="chartContainer">
            <h3>ğŸ“ˆ æš´å¯Œè»Œè·¡åœ–ï¼ˆçœ‹éŒ¢éŒ¢æ€éº¼é•·å¤§ï¼‰</h3>
            <div class="chart">
                <div class="chart-bars" id="chartBars">
                    <!-- åœ–è¡¨æŸ±ç‹€åœ–æœƒåœ¨é€™è£¡ç”Ÿæˆ -->
                </div>
            </div>
        </div>
        
        <!-- æŠ•è³‡æƒ…å¢ƒæ¯”è¼ƒ -->
        <div class="scenarios hidden" id="scenarios">
            <h3>ğŸ­ ä¸åŒèººè³ºç­–ç•¥æ¯”è¼ƒï¼ˆé¸ä½ çš„ç™¼è²¡è·¯ç·šï¼‰</h3>
            <div class="scenario-grid" id="scenarioGrid">
                <!-- æƒ…å¢ƒå¡ç‰‡æœƒåœ¨é€™è£¡ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- é å°¾ -->
        <div class="footer">
            <p>ğŸ“š æŠ•è³‡æœ‰é¢¨éšªï¼Œç†è²¡éœ€è¬¹æ…ã€‚æœ¬å·¥å…·åƒ…ä¾›åƒè€ƒï¼Œä¸æ§‹æˆæŠ•è³‡å»ºè­°ã€‚</p>
            <p>ğŸ’¡ è¨˜ä½ï¼šæœ€å¥½çš„æŠ•è³‡æ˜¯æŠ•è³‡è‡ªå·±çš„çŸ¥è­˜å’Œèƒ½åŠ›ï¼</p>
            <div style="margin-top: 20px;">
                <button class="share-btn" onclick="shareResult()">ğŸ“± åˆ†äº«çµæœ</button>
                <button class="share-btn" onclick="resetCalculator()">ğŸ”„ é‡æ–°è¨ˆç®—</button>
            </div>
        </div>
    </div>
    
    <script>
        // æ ¼å¼åŒ–é‡‘é¡é¡¯ç¤º
        function formatMoney(amount) {
            if (amount >= 1000000000) {
                return (amount / 1000000000).toFixed(1) + 'å„„';
            } else if (amount >= 10000) {
                return (amount / 10000).toFixed(1) + 'è¬';
            } else {
                return Math.round(amount).toLocaleString();
            }
        }
        
        // æ¨¡å¼åˆ‡æ›åŠŸèƒ½
        function switchMode(mode) {
            const forwardBtn = document.getElementById('forwardMode');
            const reverseBtn = document.getElementById('reverseMode');
            const forwardInputs = document.getElementById('forwardInputs');
            const reverseInputs = document.getElementById('reverseInputs');
            
            if (mode === 'forward') {
                forwardBtn.classList.add('active');
                reverseBtn.classList.remove('active');
                forwardInputs.classList.remove('hidden');
                reverseInputs.classList.add('hidden');
                calculateCompound();
            } else {
                reverseBtn.classList.add('active');
                forwardBtn.classList.remove('active');
                reverseInputs.classList.remove('hidden');
                forwardInputs.classList.add('hidden');
                calculateReverse();
            }
        }
        
        // è¤‡åˆ©è¨ˆç®—ä¸»å‡½æ•¸
        function calculateCompound() {
            const principal = parseFloat(document.getElementById('principal').value) || 0;
            const rate = parseFloat(document.getElementById('rate').value) / 100 || 0;
            const years = parseInt(document.getElementById('years').value) || 0;
            const monthly = parseFloat(document.getElementById('monthly').value) || 0;
            
            if (principal <= 0 || rate <= 0 || years <= 0) {
                return;
            }
            
            let yearlyData = [];
            let currentAmount = principal;
            let totalInvested = principal;
            
            for (let year = 1; year <= years; year++) {
                const yearStartAmount = currentAmount;
                const yearlyContribution = monthly * 12;
                const interestEarned = (currentAmount + yearlyContribution / 2) * rate;
                
                currentAmount = currentAmount * (1 + rate) + yearlyContribution * (1 + rate / 2);
                totalInvested += yearlyContribution;
                
                yearlyData.push({
                    year: year,
                    startAmount: yearStartAmount,
                    contribution: yearlyContribution,
                    interest: interestEarned,
                    endAmount: currentAmount
                });
            }
            
            const finalAmount = currentAmount;
            const totalProfit = finalAmount - totalInvested;
            const monthlyProfit = totalProfit / (years * 12);
            const roi = ((finalAmount - totalInvested) / totalInvested) * 100;
            
            // æ›´æ–°çµæœé¡¯ç¤º
            document.getElementById('finalAmount').textContent = '$' + formatMoney(finalAmount);
            document.getElementById('totalInvested').textContent = '$' + formatMoney(totalInvested);
            document.getElementById('totalProfit').textContent = '$' + formatMoney(totalProfit);
            document.getElementById('monthlyProfit').textContent = '$' + formatMoney(monthlyProfit);
            document.getElementById('roi').textContent = roi.toFixed(1) + '%';
            
            // é‡ç½®çµæœæ¨™é¡Œ
            const resultSection = document.querySelector('.result-section h2');
            resultSection.innerHTML = 'ğŸ“Š ä½ çš„ç™¼è²¡é æ¸¬';
            resultSection.style.color = '#667eea';
            
            // é¡¯ç¤ºåœ–è¡¨å’Œè¡¨æ ¼
            showChart(yearlyData);
            showScenarios(principal, rate, years, monthly);
            
            // é¡¯ç¤ºéš±è—çš„å€åŸŸ
            ['chartContainer', 'scenarios'].forEach(function(id) {
                const element = document.getElementById(id);
                element.classList.remove('hidden');
                element.classList.add('fade-in');
            });
            
            // å­˜å„²çµæœç”¨æ–¼åˆ†äº«
            window.currentResult = {
                finalAmount: finalAmount,
                totalInvested: totalInvested,
                totalProfit: totalProfit,
                years: years,
                roi: roi
            };
        }
        
        // åå‘è¨ˆç®—ï¼šé”æˆç›®æ¨™éœ€è¦å¤šä¹…
        function calculateReverse() {
            const targetAmount = parseFloat(document.getElementById('targetAmount').value) || 0;
            const rate = parseFloat(document.getElementById('targetRate').value) / 100 || 0;
            const initialAmount = parseFloat(document.getElementById('initialAmount').value) || 0;
            const monthlyAmount = parseFloat(document.getElementById('targetMonthly').value) || 0;
            
            if (targetAmount <= 0 || rate <= 0) {
                return;
            }
            
            // è¨ˆç®—éœ€è¦çš„å¹´æ•¸
            let years = 0;
            let currentAmount = initialAmount;
            let yearlyData = [];
            let totalInvested = initialAmount;
            
            while (currentAmount < targetAmount && years < 50) {
                years++;
                const yearStartAmount = currentAmount;
                const yearlyContribution = monthlyAmount * 12;
                const interestEarned = (currentAmount + yearlyContribution / 2) * rate;
                
                currentAmount = currentAmount * (1 + rate) + yearlyContribution * (1 + rate / 2);
                totalInvested += yearlyContribution;
                
                yearlyData.push({
                    year: years,
                    startAmount: yearStartAmount,
                    contribution: yearlyContribution,
                    interest: interestEarned,
                    endAmount: currentAmount
                });
            }
            
            const finalAmount = currentAmount;
            const totalProfit = finalAmount - totalInvested;
            const monthlyProfit = totalProfit / (years * 12);
            const roi = ((finalAmount - totalInvested) / totalInvested) * 100;
            
            // æ›´æ–°çµæœé¡¯ç¤º
            document.getElementById('finalAmount').textContent = '$' + formatMoney(finalAmount);
            document.getElementById('totalInvested').textContent = '$' + formatMoney(totalInvested);
            document.getElementById('totalProfit').textContent = '$' + formatMoney(totalProfit);
            document.getElementById('monthlyProfit').textContent = '$' + formatMoney(monthlyProfit);
            document.getElementById('roi').textContent = roi.toFixed(1) + '%';
            
            // é¡¯ç¤ºç›®æ¨™é”æˆä¿¡æ¯
            updateResultTitle(years, targetAmount, currentAmount >= targetAmount);
            
            // é¡¯ç¤ºåœ–è¡¨å’Œè¡¨æ ¼
            showChart(yearlyData);
            showReverseScenarios(targetAmount, initialAmount, monthlyAmount);
            
            // é¡¯ç¤ºéš±è—çš„å€åŸŸ
            ['chartContainer', 'scenarios'].forEach(function(id) {
                const element = document.getElementById(id);
                element.classList.remove('hidden');
                element.classList.add('fade-in');
            });
            
            // å­˜å„²çµæœç”¨æ–¼åˆ†äº«
            window.currentResult = {
                finalAmount: finalAmount,
                totalInvested: totalInvested,
                totalProfit: totalProfit,
                years: years,
                roi: roi,
                targetAmount: targetAmount,
                achieved: currentAmount >= targetAmount
            };
        }
        
        // æ›´æ–°çµæœæ¨™é¡Œ
        function updateResultTitle(years, targetAmount, achieved) {
            const resultSection = document.querySelector('.result-section h2');
            if (achieved) {
                resultSection.innerHTML = 'ğŸ‰ çˆ½ï¼' + years + 'å¹´å¾Œå°±èƒ½é”æ¨™';
                resultSection.style.color = '#11998e';
            } else {
                resultSection.innerHTML = 'ğŸ˜… éœ€è¦è¶…é50å¹´æ‰èƒ½é”æˆï¼ˆå¤ªé›£äº†å§ï¼‰';
                resultSection.style.color = '#e74c3c';
            }
        }
        
        // é¡¯ç¤ºåœ–è¡¨
        function showChart(data) {
            const chartBars = document.getElementById('chartBars');
            chartBars.innerHTML = '';
            
            const maxAmount = Math.max.apply(Math, data.map(function(d) { return d.endAmount; }));
            
            data.forEach(function(yearData, index) {
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                
                const height = (yearData.endAmount / maxAmount) * 250;
                bar.style.height = height + 'px';
                
                bar.innerHTML = '<div class="tooltip">ç¬¬' + yearData.year + 'å¹´<br>èº«åƒ¹$' + formatMoney(yearData.endAmount) + '</div><div class="year-label">' + yearData.year + '</div>';
                
                chartBars.appendChild(bar);
            });
        }
        
        // é¡¯ç¤ºä¸åŒæƒ…å¢ƒæ¯”è¼ƒ
        function showScenarios(principal, baseRate, years, monthly) {
            const scenarios = [
                { name: 'ä½›ç³»èººè³º', desc: 'å®šå­˜ã€å‚µåˆ¸', rate: 0.02, emoji: 'ğŸ§˜â€â™‚ï¸' },
                { name: 'ç©©å¥è‡´å¯Œ', desc: 'ETFã€åŸºé‡‘', rate: 0.06, emoji: 'ğŸ“Š' },
                { name: 'ç©æ¥µæš´å¯Œ', desc: 'å€‹è‚¡ã€æˆé•·è‚¡', rate: 0.10, emoji: 'ğŸ“ˆ' },
                { name: 'YOLOæ¢­å“ˆ', desc: 'åŠ å¯†è²¨å¹£ã€æœŸæ¬Š', rate: 0.15, emoji: 'ğŸš€' }
            ];
            
            const scenarioGrid = document.getElementById('scenarioGrid');
            scenarioGrid.innerHTML = '';
            
            scenarios.forEach(function(scenario) {
                const finalAmount = calculateScenario(principal, scenario.rate, years, monthly);
                const card = document.createElement('div');
                card.className = 'scenario-card';
                card.innerHTML = '<div class="scenario-title">' + scenario.emoji + ' ' + scenario.name + '</div><div class="scenario-desc">' + scenario.desc + '<br>å¹´è³º ' + (scenario.rate * 100).toFixed(1) + '%</div><div class="scenario-result">$' + formatMoney(finalAmount) + '</div>';
                scenarioGrid.appendChild(card);
            });
        }
        
        // åå‘è¨ˆç®—çš„æƒ…å¢ƒæ¯”è¼ƒ
        function showReverseScenarios(targetAmount, initialAmount, monthlyAmount) {
            const scenarios = [
                { name: 'å¤šæŠ•é»éŒ¢', desc: 'æ¯æœˆå¤šç ¸3000å…ƒ', monthly: monthlyAmount + 3000, emoji: 'ğŸ’ª' },
                { name: 'é¸æ›´çŒ›çš„', desc: 'è²·æˆé•·è‚¡è¡ä¸€æ³¢', rate: 0.12, monthly: monthlyAmount, emoji: 'ğŸš€' },
                { name: 'åŠ ç¢¼æœ¬é‡‘', desc: 'å¤šæŠ•å…¥10è¬å•Ÿå‹•é‡‘', initial: initialAmount + 100000, monthly: monthlyAmount, emoji: 'ğŸ’°' },
                { name: 'å…¨é¢é–‹ç«', desc: 'å¤šæŠ•è³‡+é«˜å ±é…¬', monthly: monthlyAmount + 2000, rate: 0.10, emoji: 'âš¡' }
            ];
            
            const scenarioGrid = document.getElementById('scenarioGrid');
            scenarioGrid.innerHTML = '';
            
            const baseRate = parseFloat(document.getElementById('targetRate').value) / 100;
            
            scenarios.forEach(function(scenario) {
                const rate = scenario.rate || baseRate;
                const monthly = scenario.monthly || monthlyAmount;
                const initial = scenario.initial || initialAmount;
                
                const years = calculateYearsNeeded(targetAmount, rate, initial, monthly);
                const card = document.createElement('div');
                card.className = 'scenario-card';
                card.innerHTML = '<div class="scenario-title">' + scenario.emoji + ' ' + scenario.name + '</div><div class="scenario-desc">' + scenario.desc + '</div><div class="scenario-result">' + (years < 50 ? years + 'å¹´å°±ç™¼è²¡' : 'å¤ªé›£äº†è¶…é50å¹´') + '</div>';
                scenarioGrid.appendChild(card);
            });
        }
        
        // è¨ˆç®—é”æˆç›®æ¨™éœ€è¦çš„å¹´æ•¸
        function calculateYearsNeeded(targetAmount, rate, initialAmount, monthlyAmount) {
            let years = 0;
            let currentAmount = initialAmount;
            
            while (currentAmount < targetAmount && years < 50) {
                years++;
                currentAmount = currentAmount * (1 + rate) + monthlyAmount * 12 * (1 + rate / 2);
            }
            
            return years;
        }
        
        // è¨ˆç®—ç‰¹å®šæƒ…å¢ƒçš„çµæœ
        function calculateScenario(principal, rate, years, monthly) {
            let amount = principal;
            for (let year = 1; year <= years; year++) {
                amount = amount * (1 + rate) + monthly * 12 * (1 + rate / 2);
            }
            return amount;
        }
        
        // åˆ†äº«çµæœ
        function shareResult() {
            if (!window.currentResult) {
                alert('è«‹å…ˆè¨ˆç®—çµæœï¼');
                return;
            }
            
            const result = window.currentResult;
            let shareText = `ğŸ’° æˆ‘çš„ç™¼è²¡è¨ˆç®—çµæœï¼š\n`;
            shareText += `ğŸ¯ æœ€çµ‚èº«åƒ¹ï¼š$${formatMoney(result.finalAmount)}\n`;
            shareText += `ğŸ’µ ç¸½æŠ•å…¥ï¼š$${formatMoney(result.totalInvested)}\n`;
            shareText += `âœ¨ è¤‡åˆ©è³ºäº†ï¼š$${formatMoney(result.totalProfit)}\n`;
            shareText += `ğŸ“ˆ æš´å¯ŒæŒ‡æ•¸ï¼š${result.roi.toFixed(1)}%\n`;
            shareText += `â° æŠ•è³‡å¹´é™ï¼š${result.years}å¹´\n\n`;
            shareText += `å¿«ä¾†è©¦è©¦ä½ çš„ç™¼è²¡è»Œè·¡ï¼`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'ç™¼è²¡è¨ˆç®—æ©Ÿ - æˆ‘çš„æŠ•è³‡çµæœ',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                // è¤‡è£½åˆ°å‰ªè²¼æ¿
                navigator.clipboard.writeText(shareText).then(function() {
                    alert('çµæœå·²è¤‡è£½åˆ°å‰ªè²¼æ¿ï¼');
                });
            }
        }
        
        // é‡ç½®è¨ˆç®—å™¨
        function resetCalculator() {
            // é‡ç½®æ‰€æœ‰è¼¸å…¥å€¼ç‚ºé è¨­å€¼
            document.getElementById('principal').value = 100000;
            document.getElementById('rate').value = 8;
            document.getElementById('years').value = 10;
            document.getElementById('monthly').value = 5000;
            
            document.getElementById('targetAmount').value = 1000000;
            document.getElementById('targetRate').value = 8;
            document.getElementById('initialAmount').value = 50000;
            document.getElementById('targetMonthly').value = 10000;
            
            // åŒæ­¥æ»‘æ¡¿
            syncAllSliders();
            
            // é‡æ–°è¨ˆç®—
            if (document.getElementById('forwardMode').classList.contains('active')) {
                calculateCompound();
            } else {
                calculateReverse();
            }
        }
        
        // åŒæ­¥æ‰€æœ‰æ»‘æ¡¿
        function syncAllSliders() {
            const inputs = [
                { input: 'principal', slider: 'principalSlider' },
                { input: 'rate', slider: 'rateSlider' },
                { input: 'years', slider: 'yearsSlider' },
                { input: 'monthly', slider: 'monthlySlider' },
                { input: 'targetAmount', slider: 'targetSlider' },
                { input: 'targetRate', slider: 'targetRateSlider' },
                { input: 'initialAmount', slider: 'initialSlider' },
                { input: 'targetMonthly', slider: 'targetMonthlySlider' }
            ];
            
            inputs.forEach(function(item) {
                const input = document.getElementById(item.input);
                const slider = document.getElementById(item.slider);
                if (input && slider) {
                    slider.value = input.value;
                }
            });
        }
        
        // åŒæ­¥æ»‘æ¡¿å’Œè¼¸å…¥æ¡†
        function syncInputs() {
            const inputs = [
                { input: 'principal', slider: 'principalSlider' },
                { input: 'rate', slider: 'rateSlider' },
                { input: 'years', slider: 'yearsSlider' },
                { input: 'monthly', slider: 'monthlySlider' },
                { input: 'targetAmount', slider: 'targetSlider' },
                { input: 'targetRate', slider: 'targetRateSlider' },
                { input: 'initialAmount', slider: 'initialSlider' },
                { input: 'targetMonthly', slider: 'targetMonthlySlider' }
            ];
            
            inputs.forEach(function(item) {
                const input = document.getElementById(item.input);
                const slider = document.getElementById(item.slider);
                
                if (input && slider) {
                    input.addEventListener('input', function() {
                        slider.value = input.value;
                        if (document.getElementById('forwardMode').classList.contains('active')) {
                            calculateCompound();
                        } else {
                            calculateReverse();
                        }
                    });
                    
                    slider.addEventListener('input', function() {
                        input.value = slider.value;
                        if (document.getElementById('forwardMode').classList.contains('active')) {
                            calculateCompound();
                        } else {
                            calculateReverse();
                        }
                    });
                }
            });
        }
        
        // å„²å­˜å’ŒåŠ è¼‰è¨­å®š
        function saveSettings() {
            const settings = {
                principal: document.getElementById('principal').value,
                rate: document.getElementById('rate').value,
                years: document.getElementById('years').value,
                monthly: document.getElementById('monthly').value,
                targetAmount: document.getElementById('targetAmount').value,
                targetRate: document.getElementById('targetRate').value,
                initialAmount: document.getElementById('initialAmount').value,
                targetMonthly: document.getElementById('targetMonthly').value,
                mode: document.getElementById('forwardMode').classList.contains('active') ? 'forward' : 'reverse'
            };
            localStorage.setItem('wealth-calculator-settings', JSON.stringify(settings));
        }
        
        function loadSettings() {
            const saved = localStorage.getItem('wealth-calculator-settings');
            if (saved) {
                const settings = JSON.parse(saved);
                
                document.getElementById('principal').value = settings.principal || 100000;
                document.getElementById('rate').value = settings.rate || 8;
                document.getElementById('years').value = settings.years || 10;
                document.getElementById('monthly').value = settings.monthly || 5000;
                document.getElementById('targetAmount').value = settings.targetAmount || 1000000;
                document.getElementById('targetRate').value = settings.targetRate || 8;
                document.getElementById('initialAmount').value = settings.initialAmount || 50000;
                document.getElementById('targetMonthly').value = settings.targetMonthly || 10000;
                
                syncAllSliders();
                
                if (settings.mode) {
                    switchMode(settings.mode);
                }
            }
        }
        
        // è‡ªå‹•ä¿å­˜è¨­å®š
        function autoSave() {
            const inputs = document.querySelectorAll('input');
            inputs.forEach(function(input) {
                input.addEventListener('change', saveSettings);
            });
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            syncInputs();
            autoSave();
            loadSettings();
            if (!localStorage.getItem('wealth-calculator-settings')) {
                switchMode('forward');
            }
        });
    </script>
</body>
</html>
